---
title: 《淘宝技术这十年》
date: 2019-04-18 16:58:47
tags:
	- 读书
---

《淘宝技术这十年》读书笔记

# 引言
本节用“光棍节的狂欢”这一案例表现出 普通用户在使用淘宝网时，系统中发生的事情，简述如下：

1. 访问一个网页的全过程：
- 解析主机名：从网址中解析到主机名称：如http://www.example.com/hello.html则会将主机名www.example.com解析出来。
- 查找ip: DNS 层层上找，找到即返回IP地址
- 通过ARP协议找到主机的mac地址
- 与主机进行TCP连接，三次握手
- 发送与收取数据（浏览器与目的主机开始HTTP访问过程）
- 与目的主机断开TCP连接（四次挥手）

对于淘宝而言：

- 在dns解析的时候使用了LVS（linux Virtual ）做负载均衡找到比较空闲的那台主机的ip；
- 在请求资源返回html,css,js时,前端人员将这些资源存储在不同的服务器上，以绕过浏览器对同一个域名下并发加载资源数量的限制。
- 由于访问流量较大，淘宝网使用了CDN（content dilivery network）进行加速
- 卖家发布新的宝贝，如何更新到全国各地的CDN中？淘宝如何保存海量数据？
- 内容分发与同步技术
- TFS(TaoBao File System) 实现分布式文件系统

3. 用户搜索;
- 分词
- 购物意图解析： 浏览型、查询型、对比型、确定型…

4. 购买记录及分析：
- 对每年数十亿交易的快照进行保存和快速调用： Tair(淘宝的分布式KV存储方案)
- 交易的访问日志记录： TimeTunnel(淘宝的快速、实时、同步传输数据的技术)
- 海量数据存储： 基于Hadoop的“云梯”
- 海量数据分析系统：ODPS(淘宝的数据系统)

# 第一章： 个人网站
- 2003年4月7日：十人团队开始搭建淘宝网，技术选型为：LAMP(linux+Apache+Mysql+php)
- 系统架构：一个小网站 + 一个论坛社区

    ![taobao 最早的系统架构](https://selfstudy.oss-cn-beijing.aliyuncs.com/blog/1.%E6%B7%98%E5%AE%9D%E6%9E%B6%E6%9E%84.png)

    主要是对数据库的一个更改：1主2从，读写分离（提高效率），存储容量增加，备份使得更安全了。

- DB细节：使用的MySQL4的MyISAM存储引擎，写数据的时候会锁表（不好）

    回顾一下MyISAM存储引擎的优点：

    - 全文索引
    - COUNT() 很快
    - 大批的inserts 语句在MyISAM下会快一些
    - 小型的应用或项目